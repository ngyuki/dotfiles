#!/bin/bash

# aws-vault のデフォルトの prompt が標準入出力を使うため ssh の ProxyCommand で扱えない問題に対応
# @see https://twitter.com/ngyuki/status/1525977294136676352

title=
inputbox=

while [ $# -ne 0 ]; do
  case "$1" in
    --inputbox)
      shift
      inputbox=$1
      ;;
    --title)
      shift
      title=$1
      ;;
    *)
      echo "unknown kdialog options [$1]" 1>&2
      exit 1
  esac
  shift
done

exec </dev/tty 2>/dev/tty
read -p "[$title] $inputbox" -r input
echo -n "$input"
